<!DOCTYPE html>
<html lang="en">
  <head>
    <!--Define d3 source-->

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <button onclick="update(data1, '#69b3a2')">Variable 1</button>
    <button onclick="update(data2, 'red')">Variable 2</button>
  </head>
  <body>
    <script>
      // Dataset to initilise the nodes

      dataset = [
        {
          radius: 19.895666385307514,
        },
        {
          radius: 23.964572970647247,
        },
        {
          radius: 4.841308713084549,
        },
        {
          radius: 6.824328069968236,
        },
        {
          radius: 18.64290039479465,
        },
        {
          radius: 23.550486303667423,
        },
        {
          radius: 11.650834556285849,
        },
        {
          radius: 17.001148376250384,
        },
        {
          radius: 12.404335471172034,
        },
        {
          radius: 0.8124082650932674,
        },
        {
          radius: 2.456791658583038,
        },
        {
          radius: 0.5510744076386631,
        },
        {
          radius: 10.741619667413454,
        },
        {
          radius: 12.711091410208075,
        },
        {
          radius: 14.943749816981388,
        },
        {
          radius: 15.511395178611473,
        },
        {
          radius: 22.462230560865205,
        },
        {
          radius: 17.42839329462754,
        },
        {
          radius: 23.03083978467585,
        },
        {
          radius: 21.28262905412765,
        },
        {
          radius: 10.195468435196432,
        },
        {
          radius: 20.730869644029397,
        },
        {
          radius: 23.17840511352143,
        },
        {
          radius: 16.571856512200636,
        },
        {
          radius: 19.881367816463115,
        },
        {
          radius: 8.052911265279237,
        },
        {
          radius: 15.659665463206554,
        },
        {
          radius: 23.347011714526253,
        },
        {
          radius: 3.4114847633003627,
        },
        {
          radius: 0.540545804556436,
        },
        {
          radius: 13.431193521733945,
        },
        {
          radius: 8.23992119884375,
        },
        {
          radius: 15.235087092896455,
        },
        {
          radius: 13.39989351357001,
        },
        {
          radius: 24.52372380716842,
        },
        {
          radius: 8.880839707237811,
        },
        {
          radius: 15.221401839936547,
        },
        {
          radius: 1.8941202415029113,
        },
        {
          radius: 10.079117831606702,
        },
        {
          radius: 22.87439383036208,
        },
        {
          radius: 19.226062760504924,
        },
        {
          radius: 10.025012393524444,
        },
        {
          radius: 16.58618623340206,
        },
        {
          radius: 7.147494324196043,
        },
        {
          radius: 7.046084601793093,
        },
        {
          radius: 8.952314008794811,
        },
        {
          radius: 24.519936820731843,
        },
        {
          radius: 18.3190200633073,
        },
        {
          radius: 6.77364027437761,
        },
        {
          radius: 24.168052229268895,
        },
        {
          radius: 5.418787459482624,
        },
        {
          radius: 16.316447263026625,
        },
        {
          radius: 16.62886880833975,
        },
        {
          radius: 1.8909699775970956,
        },
        {
          radius: 23.444996198375367,
        },
        {
          radius: 15.792967963982038,
        },
        {
          radius: 9.77779213533455,
        },
        {
          radius: 8.38899190600895,
        },
        {
          radius: 13.916828042196833,
        },
        {
          radius: 21.75713856513091,
        },
        {
          radius: 24.188721862648645,
        },
        {
          radius: 8.401388725908992,
        },
        {
          radius: 20.517312314267784,
        },
        {
          radius: 18.457359526802016,
        },
        {
          radius: 7.5313966552717435,
        },
        {
          radius: 19.29402030678311,
        },
        {
          radius: 14.646909173079987,
        },
        {
          radius: 23.5174561699966,
        },
        {
          radius: 12.943795081403605,
        },
        {
          radius: 18.40347877665969,
        },
        {
          radius: 7.539225693048196,
        },
        {
          radius: 16.797960298426506,
        },
        {
          radius: 18.033996339076264,
        },
        {
          radius: 12.384749003728036,
        },
        {
          radius: 18.27119293580418,
        },
        {
          radius: 1.3347032725059993,
        },
        {
          radius: 8.372957625469521,
        },
        {
          radius: 20.874099624185803,
        },
        {
          radius: 21.93857173919731,
        },
        {
          radius: 12.103453472358927,
        },
        {
          radius: 12.624774445113554,
        },
        {
          radius: 23.645913188283018,
        },
        {
          radius: 5.174409186339105,
        },
        {
          radius: 24.75980300830049,
        },
        {
          radius: 4.375832596376131,
        },
        {
          radius: 10.557597818587142,
        },
        {
          radius: 14.415927441944612,
        },
        {
          radius: 3.4551757184245275,
        },
        {
          radius: 19.102804432331027,
        },
        {
          radius: 14.866947952818684,
        },
        {
          radius: 9.329543293575181,
        },
        {
          radius: 11.999351493932373,
        },
        {
          radius: 22.92260037403987,
        },
        {
          radius: 5.106480304746097,
        },
        {
          radius: 10.017918140292753,
        },
        {
          radius: 16.676957233005297,
        },
        {
          radius: 18.099059903971245,
        },
        {
          radius: 7.037973578559412,
        },
        {
          radius: 7.71366297192182,
        },
        {
          radius: 2.135309495807966,
        },
      ];
      // set a colour scale with a colour for each item in the dataset
      var myColor0 = d3.scaleLinear().domain([1, 100]).range(["red", "blue"]);
      // Add a text div to display the rgb value of a node
      d3.select("body")
        .append("div")
        .attr("id", "rgbVal")
        .attr("style", "position: absolute;");
      // Set dimensions
      var width = 400,
        height = 400;
      // setup svg
      var svg = d3
        .select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      // Call a simulation with preset values
      // Force many body charges, center and collision
      var simulation = d3
        .forceSimulation(dataset)

        .force("charge", d3.forceManyBody().strength(5))
        .force("center", d3.forceCenter(width / 2, height / 2))
        .force(
          "collision",
          d3.forceCollide().radius(function (d) {
            return d.radius;
          })
        )
        .on("tick", ticked);

      function ticked() {
        // Add circles to the svg based on the dataset
        // Collours are determined by the range
        var u = d3
          .select("svg")
          .selectAll("circle")
          .data(dataset)
          .join("circle")
          .attr("fill", function (d, i) {
            return myColor0(i);
          })
          .attr("r", function (d) {
            return d.radius;
          })
          .attr("cx", function (d) {
            return d.x;
          })
          .attr("cy", function (d) {
            return d.y;
          })
          // Mouseover and mouseout functions
          .on("mouseover", onMouseOver)
          .on("mouseout", onMouseOut);
      }

      //mouseover event handler function
      function onMouseOver(d, i) {
        // Change the colour of the node

        d3.select(this).style("fill", "#014421");
        // Change the text at the top to display the rgb value of the nodes colour

        svg
          .append("text")
          .attr("class", "val")
          .attr("x", d3.select(this).attr("x"))
          .attr("y", d3.select(this).attr("y") - 25);
        d3.select("#rgbVal")
          .style("opacity", 1)
          .text(d3.select(this).attr("fill"));
      }
      //mouseout event handler function
      function onMouseOut(d, i) {
        // Change the colour upon mouseout
        d3.select(this).style("fill", "#7FFF00");
      }
    </script>
  </body>
</html>
